package main

import (
	"context"
	"fmt"
	"log"

	"github.com/milvus-io/milvus-sdk-go/v2/entity"
)

var queryEmbedding = []float32{0.0060837916, -0.011322426, -0.0069021187, -0.0018546509, -0.007968627, 0.004024559, -0.008189978, -0.012482841, 0.006627107, -0.030452497, 0.016447032, -0.01974717, -0.025743762, -0.022644851, -0.019277638, 0.0065667387, 0.0138444835, -0.0025690102, 0.008894276, -0.009249778, -0.013777407, -0.00096757105, -0.010819356, 0.01600433, -0.014407922, -0.0006690829, 0.030372005, -0.008646094, 0.026360862, -0.011624268, 0.004742272, 0.0034611209, -0.014381091, -0.016648259, 0.004712088, -0.00051187363, 0.016997054, 0.0021414007, 0.007203961, -0.022457039, 0.02787678, 0.001629108, -0.016071405, -0.009437591, -0.035603933, -0.014126202, 0.0072240834, -0.029057316, 0.000005521978, 0.024201015, 0.02625354, 0.011711467, 0.019867906, -0.0077942293, -0.023798559, -0.03691862, -0.012838343, 0.005077652, 0.018258084, -0.009766263, -0.004363293, 0.0023912587, -0.020431345, 0.012194414, 0.003991021, -0.0073917736, -0.031659864, 0.021585051, 0.01259687, -0.011335841, 0.011610853, 0.0089412285, 0.013173724, -0.019156901, 0.029513434, -0.010510807, -0.02116918, -0.014729886, -0.008780247, 0.014340845, 0.0043431697, -0.0071771303, -0.02072648, 0.0077942293, -0.0035449658, -0.012362104, 0.013327998, -0.00011245708, -0.008558895, -0.02633403, -0.0034980127, 0.014434752, -0.0046886113, 0.014072541, -0.021732619, -0.0016727074, -0.018392235, -0.0039541293, -0.01231515, -0.03882358, 0.02449615, 0.022738758, -0.0117382975, -0.0231278, -0.03606005, 0.010718742, 0.011248643, -0.0022503992, 0.041828584, 0.010658374, 0.0011151382, 0.023382688, -0.014984774, -0.043143272, -0.008719878, 0.00061919517, 0.043116443, 0.00357515, 0.010215673, -0.026132803, 0.017936118, 0.013039571, -0.0026008713, -0.0060904995, 0.01463598, 0.015548213, -0.000071635055, 0.0010883078, -0.0040513896, -0.018150762, 0.02687064, -0.019693509, -0.01223466, 0.016862903, 0.020243531, 0.011476701, -0.010202257, 0.0033001385, -0.0043834154, -0.01667509, 0.013247507, 0.027742626, -0.023221705, 0.0045007984, -0.012328566, 0.035764914, -0.0026629167, 0.026763318, 0.009028427, 0.026293786, 0.004457199, -0.006164283, 0.0058054263, -0.0058859177, 0.017909288, 0.01572261, -0.0034711822, 0.0058322567, -0.0046953186, 0.025931576, -0.004292863, 0.0010128474, -0.00059320324, -0.0007051363, 0.012214537, 0.03351116, 0.025730347, 0.0043800618, -0.0120267235, -0.010229087, -0.024294922, 0.029164638, -0.040487062, 0.009055258, -0.0060368385, 0.009504667, -0.018808106, 0.0127176065, -0.0072240834, -0.032437947, 0.010846186, 0.00086444174, 0.0016475539, 0.020538665, -0.009088796, 0.0028272527, 0.007995457, -0.010906555, -0.0052017425, -0.003491305, -0.019398374, 0.009491252, -0.00064015645, -0.009451007, -0.61516726, -0.032598928, 0.0020391098, -0.0105041, 0.010309579, 0.013421904, 0.016312879, -0.00023371789, -0.018861767, 0.009142457, 0.01497136, 0.011490116, 0.02010938, -0.021196011, -0.0054868157, -0.017909288, 0.016849488, -0.026441352, 0.02178628, -0.009316854, -0.038608935, 0.0013322968, -0.0047892253, -0.014703056, -0.0159775, 0.037723534, 0.02857437, -0.007217376, -0.016929979, 0.008297299, -0.04569216, 0.006331973, 0.0017221759, -0.0013339736, 0.04636292, -0.00022994485, -0.013871313, 0.041801754, 0.017439757, 0.02563644, -0.017694645, -0.006030131, 0.047275152, -0.006462771, 0.007331405, -0.0075192177, 0.011490116, 0.01848614, 0.022014339, 0.0105041, 0.001118492, -0.02563644, -0.015682366, -0.0027585, 0.024066864, 0.0098132165, 0.008002165, 0.0057316427, 0.0059362245, 0.0040379744, -0.03324286, 0.023074139, -0.020713063, -0.015682366, -0.0079619195, -0.0002846537, -0.017158037, 0.008914398, 0.01731902, -0.013978635, -0.0046081203, 0.043921355, -0.030559817, -0.013066402, -0.0134084895, 0.044699434, 0.005010576, 0.02597182, 0.011054122, 0.029835397, 0.0024918728, -0.010309579, 0.011067538, -0.0159775, 0.030398836, -0.01242918, -0.01396522, 0.013582887, -0.015293324, 0.0035483195, 0.024522979, 0.008391205, -0.016031161, -0.016165312, 0.002020664, -0.008726586, -0.004893193, 0.026749901, -0.0044840295, 0.0041016964, -0.0023510132, -0.039199203, 0.029057316, 0.013361536, -0.007861305, 0.020230116, -0.02697796, 0.006710952, 0.023436349, -0.029781736, -0.019760584, 0.0028104838, -0.016433615, -0.012140753, 0.0034208752, -0.026736487, 0.026105972, 0.0139518045, 0.010121766, -0.027688967, 0.022685098, -0.022725344, -0.006563385, 0.011362672, 0.018781275, -0.0018580047, 0.0042492636, -0.02868169, -0.034879513, 0.011456578, -0.004346524, -0.012710899, 0.0164202, -0.035791744, 0.022054583, 0.011168151, 0.0068954113, 0.009840047, -0.0013465504, -0.037884515, -0.025716932, -0.024697376, -0.0005030699, -0.004192249, -0.03353799, -0.02212166, -0.0006565062, 0.017010469, 0.00023958703, -0.008062533, -0.019881321, -0.020458175, -0.0006938172, 0.035899065, -0.0013599655, -0.004856301, -0.0056075524, -0.019519111, -0.010497391, -0.00782106, 0.02279242, 0.0070563937, 0.018794691, -0.006529847, -0.006928949, -0.020243531, -0.004205664, -0.021383824, 0.01242918, -0.020095965, -0.016460447, -0.014246939, -0.030264683, 0.0138444835, 0.0037126557, 0.039708983, 0.005812134, 0.012489548, -0.00026851354, -0.005309064, -0.029137807, 0.028493878, -0.0013842806, -0.008498527, -0.0057014585, -0.0054130317, 0.025998652, 0.03807233, -0.0027635305, 0.029110977, -0.00621459, 0.020377684, -0.007700323, 0.00031211294, -0.016272634, 0.0119194025, 0.012254782, -0.0021296625, -0.0040547433, 0.031659864, 0.011698051, 0.009960784, 0.015279909, -0.008719878, -0.0051346663, -0.024925435, 0.01731902, -0.012295028, 0.027984101, 0.010799234, 0.025140079, -0.02002889, -0.031847678, -0.018808106, -0.00048588167, 0.022349717, -0.010470561, 0.008464989, -0.02935245, 0.0021950617, 0.0012492902, -0.02044476, 0.0139518045, -0.01874103, 0.0002691424, 0.030586649, -0.0032162934, 0.016312879, 0.009444298, -0.035657592, 0.005258757, 0.017412925, 0.007297867, 0.027688967, 0.01497136, 0.0064527094, 0.007780814, -0.013187138, 0.013247507, 0.0011067537, -0.010571175, 0.024871774, 0.026427938, 0.015266494, 0.025582781, 0.01633971, 0.033698976, -0.017654398, 0.004926731, 0.013032864, -0.012033432, 0.026441352, 0.013871313, -0.02932562, 0.009518082, -0.011932817, -0.001677738, 0.015346985, 0.003254862, 0.0022973525, 0.0013649963, -0.002270522, 0.008485112, 0.0045980588, 0.030291514, -0.019975228, 0.010544345, -0.025153494, -0.01776172, 0.0023828743, -0.020619158, -0.013831068, 0.011791958, -0.01058459, -0.015025021, 0.026521845, -0.02016304, -0.0076936153, -0.011765128, 0.03335018, -0.027527984, -0.009974198, -0.0037596088, 0.029486602, -0.011262057, -0.02658892, -0.004893193, -0.0028490524, 0.0040010824, 0.0014194956, 0.012932249, -0.015749441, 0.0022939986, 0.019814245, -0.00097427866, 0.0006212913, 0.010403485, 0.0061709904, -0.02485836, -0.017855627, -0.0018898658, 0.01106083, 0.016715335, -0.0093772225, 0.03737474, -0.017801967, -0.0024499502, -0.013227384, -0.016876318, -0.018217837, 0.0077070305, -0.01796295, -0.0028825905, -0.020002058, 0.006949072, 0.011201689, -0.00030037464, -0.0033537992, 0.011241935, -0.021987507, -0.012207829, -0.033833127, -0.04488725, -0.0027450847, 0.07110054, 0.015709195, -0.016151898, 0.019653263, -0.03750889, -0.022457039, -0.014474997, -0.014957945, 0.0033152306, -0.0142066935, 0.003172694, -0.001936819, 0.012268198, 0.008719878, -0.00009804622, 0.0044370764, 0.022349717, -0.015025021, -0.023718068, -0.0019166962, 0.006680768, -0.031015934, -0.00597647, 0.05197047, 0.019143486, -0.016661674, 0.03477219, -0.0015553244, 0.0054666926, 0.0007546048, 0.009249778, 0.004239202, -0.013790823, -0.0027065158, -0.032518435, 0.033162367, 0.027125528, 0.0046852576, 0.01044373, -0.010973631, -0.0083241295, 0.028118253, 0.00065692543, -0.03807233, -0.016594598, -0.008565603, -0.033081874, 0.023637576, -0.0025539182, -0.04359939, 0.023758313, 0.012824928, -0.027299926, -0.011490116, 0.015279909, -0.006861873, 0.0034326136, -0.008498527, -0.016929979, -0.04767761, 0.033698976, -0.020136211, -0.007955212, -0.01468964, -0.01432743, -0.025542535, -0.0015989238, 0.028842673, -0.012925542, 0.006710952, 0.005714874, -0.026025482, -0.030881783, 0.017292188, 0.013032864, -0.0010413546, 0.002106186, 0.018351989, 0.023597332, 0.01972034, 0.007854598, -0.019264223, 0.011677929, -0.021236256, 0.0016567768, -0.024482735, -0.008049118, 0.0023862282, -0.0070429784, 0.010658374, 0.0016123389, -0.0063588032, 0.022255812, 0.020055719, 0.019545943, 0.03396728, 0.02873535, -0.008706463, 0.024804698, -0.022497285, -0.028467048, -0.007398481, -0.020927707, 0.006194467, -0.019371545, 0.0077741067, -0.010517514, 0.0060368385, 0.012616993, -0.009645526, 0.013831068, 0.021249672, 0.014193278, -0.00470538, -0.005775242, 0.009638819, -0.027688967, 0.011584022, -0.009155871, -0.0035416118, 0.005895979, -0.02088746, 0.008250346, 0.008136317, -0.014394506, 0.017882457, -0.0011469993, -0.019545943, -0.010873017, 0.0102492105, 0.009182702, 0.020069133, 0.0056041987, 0.016259218, -0.022779005, -0.01874103, -0.010946801, -0.01837882, -0.007727153, -0.012751144, -0.009404053, 0.006865227, -0.02320829, -0.0045309826, -0.013676793, -0.03426241, 0.015025021, -0.007914966, -0.0011394533, 0.001386796, 0.003090526, -0.0011210074, -0.019250808, -0.00017083414, 0.010906555, -0.032196473, -0.01667509, -0.012241367, 0.019398374, -0.008418036, 0.0076802, -0.0048160558, 0.016138481, 0.019264223, 0.034745358, 0.0008954644, -0.0036153956, 0.008471697, -0.02787678, 0.006593569, 0.017976364, 0.014864038, -0.01966668, -0.025126664, -0.024683962, 0.028815843, -0.00019127136, 0.019867906, 0.0048730704, -0.047999576, -0.022537531, 0.0021514622, 0.010369947, 0.021732619, -0.012751144, 0.017010469, 0.032947723, 0.009115626, 0.0061877593, 0.013073109, -0.00042341714, -0.027447492, 0.03182085, 0.030828122, 0.013327998, -0.023302197, -0.0077070305, -0.027393831, -0.0062850197, -0.0014454875, -0.008243638, 0.011456578, 0.012690776, -0.009028427, 0.011778543, 0.041157823, 0.009437591, -0.025596196, 0.0041318806, -0.005329187, -0.015521383, 0.0077405684, -0.015427477, -0.027984101, -0.004624889, 0.007304575, 0.0033387071, 0.022537531, -0.026575506, -0.0030519573, 0.0072307913, -0.0009558328, 0.048321538, 0.013737162, 0.01938496, 0.02354367, 0.0051883273, -0.01206697, 0.030854953, -0.01662143, -0.0026008713, 0.047409307, 0.029728075, -0.020847216, -0.021960678, 0.020552082, 0.00061374524, -0.040084608, -0.005580722, 0.015803102, 0.026481599, 0.019237392, -0.027138943, -0.019264223, -0.019545943, 0.022215566, -0.038716257, 0.022322888, -0.02728651, -0.009175994, -0.011221812, 0.017198281, -0.0115639, 0.023302197, -0.02351684, 0.012771267, 0.003390691, 0.0091223335, -0.009236363, 0.017359264, 0.005164851, 0.03876992, -0.0025036111, 0.0027786226, 0.022269227, -0.015494552, -0.008236931, -0.006462771, -0.011141321, 0.035335626, -0.013817653, -0.00056134217, -0.02661575, 0.0012736053, -0.013616425, 0.010282748, 0.0121005075, -0.004863009, 0.015561628, -0.021719204, 0.02153139, -0.007914966, -0.028252404, -0.000075460484, 0.0006036839, -0.027125528, -0.02426809, 0.0039138836, 0.0023392749, -0.049582567, -0.0121005075, 0.0015905392, -0.01273773, 0.009611988, -0.009330269, 0.0013155277, -0.031096427, 0.008934521, -0.052050963, 0.023436349, 0.006774674, -0.010101643, -0.030398836, -0.001636654, -0.0067042448, -0.043331087, 0.023342442, -0.022282641, -0.05999276, -0.014193278, 0.021920431, -0.0075058024, -0.022068, -0.02217532, -0.002387905, -0.004879778, 0.00874, 0.0035650886, -0.02413394, 0.03267942, -0.012502964, 0.013569471, 0.00015416996, -0.01564212, 0.03552344, 0.019062994, 0.030532988, -0.013361536, -0.0019016041, -0.021209426, 0.028708521, 0.011718174, -0.0015947315, -0.0052554035, -0.015494552, -0.014528658, -0.036382012, -0.013857898, 0.0047523333, -0.017721474, -0.0016894763, 0.037025943, -0.003189463, -0.015105512, 0.0068887034, 0.0051011285, -0.017265359, -0.008431451, -0.05465351, -0.02723285, -0.033108704, 0.053016856, -0.012415765, -0.030989105, -0.035657592, -0.022389963, -0.055646237, -0.026119389, -0.002054202, -0.011463285, 0.010101643, -0.0066740606, 0.0051782657, -0.0018144053, -0.038394295, 0.019760584, 0.0148237925, 0.0041956026, 0.037079602, -0.04174809, 0.046175107, 0.000008332095, -0.027393831, -0.023060724, 0.03541612, -0.0015762856, -0.0061206836, 0.023436349, -0.026830394, 0.04429698, 0.017104376, 0.0063084965, 0.003008358, 0.0043364624, 0.03066714, -0.048589844, 0.00597647, -0.010490684, 0.0036690563, 0.0020575558, 0.009826631, -0.0009172641, -0.0012610285, 0.019277638, -0.010517514, 0.014072541, 0.0049435, -0.00017219663, 0.051433865, -0.01242918, -0.017010469, 0.022779005, 0.015937254, 0.0005487654, -0.01639337, 0.0017657753, -0.008968059, -0.0023107675, 0.015521383, -0.027219433, 0.033698976, -0.016353125, 0.034342904, 0.004987099, 0.012080384, 0.0072374986, -0.005728289, -0.0024097047, 0.023959542, 0.022832666, -0.020243531, -0.016849488, -0.011335841, -0.009960784, 0.006147514, -0.00031546675, -0.018606879, 0.0020642634, -0.01868737, -0.0028020993, -0.016031161, -0.02935245, -0.01022238, 0.011530362, -0.018512972, -0.016715335, 0.19994009, -0.008404621, 0.017493417, 0.002954697, -0.00544657, -0.009846754, 0.02354367, 0.016151898, 0.002372813, 0.016540937, -0.006928949, 0.01840565, -0.008028995, 0.00089462596, -0.010014445, -0.022939986, -0.03396728, -0.029003656, -0.012556625, -0.016111651, 0.02377173, 0.00076005474, -0.00865951, 0.0016978609, 0.032572098, 0.005510292, -0.0010120089, 0.013160308, 0.011040707, -0.011765128, -0.016661674, -0.014407922, 0.007941796, -0.009605281, 0.011805373, -0.0063889874, 0.0090150125, -0.0064560636, 0.0036690563, 0.03351116, 0.0180971, 0.00066069845, 0.008283884, 0.0011788604, 0.02108869, 0.014273769, 0.003355476, -0.024348583, -0.0012425826, 0.006546616, -0.021316748, 0.004809348, -0.0045343367, 0.039091885, 0.020230116, -0.016608013, 0.010873017, 0.029486602, -0.004527629, 0.023946127, -0.018982504, 0.043170102, -0.022068, 0.016876318, 0.0018412358, 0.0072844517, -0.023100968, 0.014260354, 0.0021145705, -0.025904745, 0.013502396, -0.017627569, -0.017386096, 0.0070027327, -0.027688967, -0.036301523, 0.026387691, -0.0024415657, 0.016540937, 0.033028215, 0.0119194025, 0.019062994, -0.008773538, 0.026602335, -0.006412464, -0.016326295, 0.016742166, 0.0068249814, -0.0005835611, 0.008216808, 0.0010757311, -0.003043573, -0.0051514357, -0.02183994, 0.017828796, 0.01348898, 0.0078076445, 0.011684637, -0.003605334, -0.0057417043, -0.024979096, 0.033108704, 0.033806294, 0.017895872, -0.025716932, 0.008532065, 0.014944529, 0.008511943, 0.011382794, -0.022443624, 0.003524843, 0.0071435925, 0.007646662, 0.010014445, -0.005634383, 0.029969549, -0.00671766, -0.015870178, 0.008907691, -0.000097102966, -0.02217532, -0.017077545, -0.02047159, 0.01533357, -0.023476595, -0.035335626, -0.022255812, 0.024227845, -0.016916564, -0.026763318, 0.02547546, 0.033162367, 0.02795727, 0.0060200696, 0.0025924868, -0.025958406, 0.002320829, 0.0018630355, -0.012663946, -0.01605799, -0.047355644, -0.0117382975, -0.027434077, -0.018003194, 0.0028306064, -0.013260922, 0.0028641445, -0.0007311282, -0.0022269227, -0.009658942, 0.01608482, 0.0031861092, -0.021947263, -0.016500693, 0.033081874, -0.031874508, -0.02935245, -0.013160308, -0.0038333924, 0.031015934, -0.020498421, 0.012925542, 0.018365404, -0.0036489335, -0.0024432428, -0.0020843863, -0.16903149, 0.02560961, 0.032384284, -0.02499251, 0.021075275, 0.011107783, 0.011456578, -0.009645526, -0.0015829932, 0.04370671, 0.014515243, -0.0012140753, -0.013924974, -0.026749901, 0.00865951, 0.021356992, 0.029486602, 0.01913007, 0.04147979, 0.018150762, 0.0077539836, 0.0018647123, 0.040487062, 0.008243638, 0.030559817, -0.011879156, -0.0041654184, 0.008438159, 0.0142066935, 0.0054197395, -0.01039007, -0.001970357, 0.03555027, -0.008894276, 0.0004257229, 0.00170373, 0.003773024, -0.0124627175, -0.002708193, 0.03807233, 0.011537069, 0.00095415587, 0.03555027, -0.0015343631, -0.0006736944, 0.03479902, 0.018754445, -0.0076064165, 0.0038971147, -0.005644444, -0.004081574, 0.003306846, -0.0043029245, 0.0019971875, 0.029191468, 0.0024449197, 0.0076936153, -0.006831689, 0.014314015, -0.01281822, -0.011510239, -0.02653526, 0.03273308, -0.023677822, -0.013911559, 0.0037965006, -0.014515243, 0.004977038, -0.019398374, 0.00391053, 0.0065734466, 0.014381091, -0.0017993132, 0.004209018, -0.010832772, 0.006291727, -0.020149626, 0.0027367002, 0.0042995703, 0.020055719, 0.00039281373, -0.0039138836, -0.017895872, -0.008572311, 0.012643823, -0.007331405, -0.006378926, 0.030962273, -0.034557547, -0.012938958, -0.0016911533, -0.021155765, -0.002454981, -0.023060724, 0.011818788, 0.01812393, -0.0105041, 0.005909394, -0.008820492, -0.0072374986, 0.013187138, 0.0123553965, -0.017184867, 0.010987046, 0.050146006, 0.01768123, -0.022939986, 0.029245129, 0.023261951, -0.004574582, -0.04684587, 0.009625404, 0.035791744, 0.028064592, 0.0032615697, 0.004856301, 0.02795727, -0.0009650557, 0.036489334, -0.01768123, 0.055646237, 0.007921673, -0.02591816, 0.020230116, -0.02315463, -0.018003194, -0.07990091, 0.0061307447, 0.0044035385, 0.0074789724, -0.02488519, 0.02873535, 0.00082251924, -0.0019435267, -0.0020575558, 0.020069133, -0.027045038, -0.02547546, 0.0009197794, -0.010551052, -0.012415765, 0.008216808, 0.0036858253, -0.010537637, -0.01348898, 0.024871774, 0.0019099886, -0.013368243, -0.010416901, 0.011107783, 0.005610906, -0.0058490257, -0.032303795, -0.008149732, 0.0018261437, -0.0049133156, -0.017131206, -0.013468858, 0.029110977, -0.03611371, 0.024844944, 0.00991383, 0.004125173, -0.013073109, 0.018083686, -0.028440217, -0.010208964, 0.013401781, 0.02488519, -0.018673955, -0.013059694, -0.006446002, -0.018231252, 0.01678241, 0.027340172, -0.015454306, -0.025153494, -0.025019342, -0.0028104838, -0.0030821415, 0.031633034, -0.00804241, 0.023744898, -0.0016760612, -0.01943862, -0.008156439, -0.007995457, 0.0056880433, -0.0023979663, 0.023329027, 0.012637115, -0.020297192, -0.012670653, -0.013562764, 0.011932817, -0.011852327, -0.0014840561, -0.024979096, -0.01812393, 0.013623132, -0.026240125, -0.015293324, -0.012087093, -0.002473427, 0.024361998, -0.031713527, 0.015253079, -0.025059588, -0.0067411363, 0.0073917736, 0.03538929, 0.014703056, -0.017828796, -0.017023886, 0.009598574, -0.058382936, 0.018231252, 0.025435213, -0.012871881, -0.0021984153, 0.022725344, -0.000542477, 0.024348583, 0.006714306, -0.009779679, 0.03624786, -0.020431345, -0.014474997, -0.07319331, 0.015199418, 0.0034946587, -0.0011151382, -0.0012836666, -0.0048831315, 0.0099943215, 0.0025572719, 0.0015251401, 0.024201015, -0.01178525, 0.0143006, -0.006962487, 0.0050675906, -0.014340845, -0.03265259, 0.044028677, -0.008900983, 0.021585051, 0.017265359, 0.0071368846, 0.0074789724, -0.015521383, 0.0038971147, -0.014273769, 0.022939986, -0.011429748, 0.01566895, -0.0032095858, -0.022899741, 0.007331405, -0.027903609, 0.002939605, 0.025515703, -0.009571743, 0.009625404, 0.00037436784, 0.032572098, -0.020659404, 0.012529794, -0.04429698, -0.027380416, 0.0072240834, -0.0007151977, -0.027206019, -0.02457664, -0.017278774, -0.005540476, 0.02393271, 0.013676793, 0.0328404, 0.017493417, -0.009236363, 0.0027953917, -0.017815381, 0.002837314, 0.0030536342, -0.0021497852, -0.004427015, 0.010309579, 0.0477581, 0.0030804647, 0.0030955567, -0.024227845, -0.0044840295, -0.017265359, -0.020015474, -0.016889732, -0.0127176065, -0.011020584, -0.036596656, -0.0046349503, 0.0058725025, 0.036006387, 0.012415765, 0.0027266387, -0.017654398, -0.017466586, -0.04284814, 0.020967953, 0.0048428862, -0.007841183, -0.028145082, 0.00941076, -0.011879156, -0.001002786, -0.01946545, 0.008203393, 0.013227384, 0.017332435, -0.0074118963, 0.014381091, 0.018982504, -0.006258189, 0.0041821874, -0.017305603, 0.0072911596, 0.012295028, 0.014153033, 0.020498421, 0.0235705, 0.000016637989, 0.007747276, -0.047972742, -0.010483976, 0.009417468, -0.02315463, 0.0000014803879, 0.0077137384, 0.023865635, -0.007780814, 0.0051682047, -0.0015595166, -0.0040547433, -0.023342442, -0.0032364163, 0.0062380666, -0.008538772, -0.0043431697, 0.04287497, 0.017788552, 0.008075949, 0.0225107, -0.0027802996, 0.026843809, 0.021960678, 0.020900877, -0.020458175, 0.0044672606, -0.0018680661, 0.00074538187, 0.020417929, -0.01768123, -0.0067713205, -0.0123553965, -0.022457039, -0.0019418497, 0.011993186, -0.015736027, 0.08795003, 0.012187706, 0.0030704031, 0.010665081, -0.0051078363, 0.020578912, -0.0076198317, 0.025515703, -0.016098237, -0.029245129, 0.009826631, 0.002654532, 0.020404514, -0.00037939852, -0.0151323415, -0.0033504453, -0.0117382975, 0.032276962, 0.0066036307, -0.011456578, 0.02075331, -0.009665649, 0.015212833, -0.005929517, -0.020310609, -0.0044135996, -0.005158143, -0.026709657, -0.022389963, -0.014716471, 0.02256436, 0.0001834109, -0.037991837, -0.015601873, -0.01639337, -0.032196473, -0.0007328051, 0.024536395, 0.017023886, -0.0049904534, -0.0014245262, -0.0058490257, -0.0170373, -0.027447492, 0.010933385, -0.007029563, -0.0120938, -0.015253079, -0.021061858}

func main() {
	defer milvusClient.Close()
	//bulkInsert()
	bulkDelete(fmt.Sprintf("slug in [\"Who-is-Rhizome\"]"))
	//fmt.Println(fmt.Sprintf("slug in [%v]", []string{"abc-efg", "gsdjbgjkd"}))
	//query()
	//search()
}
func search() {
	sp, _ := entity.NewIndexFlatSearchParam()
	searchResult, err := milvusClient.Search(
		context.Background(),
		"chatgpt",
		[]string{},
		"",
		[]string{"title", "author", "url", "content"},
		[]entity.Vector{entity.FloatVector(queryEmbedding)},
		"embedding",
		entity.IP,
		2,
		sp,
	)
	if err != nil {
		log.Fatal(err.Error())
	}

	//var texts []string
	//fmt.Println(searchResult[0])
	//fmt.Println(searchResult[0].Fields)
	//fmt.Println(searchResult[0].ResultCount)
	//fmt.Println(searchResult[0].Fields.GetColumn("title").FieldData().GetScalars().GetStringData().GetData())
	//

	for i := 0; i < searchResult[0].ResultCount; i++ {
		fields := searchResult[0].Fields
		title, _ := fields.GetColumn("title").GetAsString(i)
		author, _ := fields.GetColumn("author").GetAsString(i)
		url, _ := fields.GetColumn("url").GetAsString(i)
		content, _ := fields.GetColumn("content").GetAsString(i)

		text := fmt.Sprintf("Title: %v Author: %v URL: %v Content: %v", title, author, url, content)
		fmt.Println(text)
	}
	//title := searchResult[0].IDs.Name()
}

func query() {
	queryResult, err := milvusClient.Query(
		context.Background(),           // ctx
		"chatgpt",                      // CollectionName
		[]string{},                     // PartitionName
		"slug in [\"Who-is-Rhizome\"]", // expr
		[]string{"updatedAt"},          // OutputFields
	)
	if err != nil {
		log.Fatal("fail to query collection:", err.Error())
	}
	lastModified := queryResult.GetColumn("updatedAt").FieldData().GetScalars().GetStringData().GetData()[0]
	fmt.Println(lastModified)
}

func bulkDelete(expr string) {
	err := milvusClient.LoadCollection(
		context.Background(), // ctx
		"chatgpt",            // CollectionName
		false,                // async
	)
	if err != nil {
		log.Fatal("failed to load collection:", err.Error())
	}

	//content := "问题：TRLab的社区 回答："
	queryResult, err := milvusClient.Query(
		context.Background(), // ctx
		"chatgpt",            // CollectionName
		[]string{},           // PartitionName
		expr,                 // expr
		[]string{"id"},       // OutputFields
	)
	if err != nil {
		log.Fatal("fail to query collection:", err.Error())
	}

	deletes := queryResult.GetColumn("id").FieldData().GetScalars().GetLongData().GetData()
	fmt.Println(deletes)
	ids := entity.NewColumnInt64("id", deletes)
	milvusClient.DeleteByPks(context.Background(), "chatgpt", "", ids)
	queryResult, err = milvusClient.Query(
		context.Background(), // ctx
		"chatgpt",            // CollectionName
		[]string{},           // PartitionName
		"content in [\" 问题：TRLab上的NFT 回答：\"]", // expr
		[]string{"id"}, // OutputFields
	)
	if err != nil {
		log.Fatal("fail to query collection:", err.Error())
	}

	deletes = queryResult.GetColumn("id").FieldData().GetScalars().GetLongData().GetData()
	fmt.Println(deletes)
}
